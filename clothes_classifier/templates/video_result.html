<!-- templates/video_result.html -->
{% extends 'base.html' %}

{% block title %}Результати аналізу відео{% endblock %}

{% block content %}
    <h1>Результати аналізу відео</h1>

    {% if video_url %}
        <video controls>
            <source src="{{ video_url }}" type="video/mp4">
            Ваш браузер не підтримує відтворення відео.
        </video>
    {% else %}
        <p>Відео не доступне.</p>
    {% endif %}

    <div class="switch-container">
        <span class="switch-label">JSON-вивід</span>
        <label class="toggle-switch">
            <input type="checkbox" id="outputToggle">
            <span class="slider"></span>
        </label>
    </div>

    <div id="outputText">
        <strong>Відсоток присутності кожної речі:</strong>
        <table>
            <thead>
                <tr>
                    <th>Клас</th>
                    <th>Загальна присутність (%)</th>
                    <th>По таймфреймах (кожні 10 сек)</th>
                </tr>
            </thead>
            <tbody>
                {% for item in summary %}
                    <tr>
                        <td>{{ item.class }}</td>
                        <td>{{ item.total_presence|floatformat:2 }}</td>
                        <td>
                            {% for frame in item.frames %}
                                {{ frame.start }}–{{ frame.end }}с: {{ frame.presence|floatformat:2 }}%<br>
                            {% endfor %}
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <pre id="jsonOutput" style="display:none;">{{ summary_json|safe|json_script:"summary-data" }}</pre>
{% endblock %}